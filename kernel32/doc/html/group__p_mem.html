<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>System Kernel: Physical memory management routines.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">System Kernel<span id="projectnumber">&#160;dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__p_mem.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Physical memory management routines.<div class="ingroups"><a class="el" href="group__mm.html">Memory management module</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa5652a7ae272940055761950cd479153"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__p_mem.html#gaa5652a7ae272940055761950cd479153">MmAllocatePhysicalMemory</a> (uintptr_t n, uintptr_t *address)</td></tr>
<tr class="memdesc:gaa5652a7ae272940055761950cd479153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate ONE physical memory block (best fit)  <br /></td></tr>
<tr class="separator:gaa5652a7ae272940055761950cd479153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa68566b055973e2e2934168fe522d8e7"><td class="memItemLeft" align="right" valign="top">EXPORT uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__p_mem.html#gaa68566b055973e2e2934168fe522d8e7">MmAllocateContiguousPhysicalMemory</a> (uintptr_t n, uintptr_t *address, uintptr_t align)</td></tr>
<tr class="memdesc:gaa68566b055973e2e2934168fe522d8e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate contiguous physical memory.  <br /></td></tr>
<tr class="separator:gaa68566b055973e2e2934168fe522d8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b35a215c11279c86f4fdd953f0677ef"><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__p_mem.html#ga7b35a215c11279c86f4fdd953f0677ef">MmFreePhysicalMemory</a> (uintptr_t address, uintptr_t n)</td></tr>
<tr class="memdesc:ga7b35a215c11279c86f4fdd953f0677ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free physical memory.  <br /></td></tr>
<tr class="separator:ga7b35a215c11279c86f4fdd953f0677ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9503a4071a5bc311a41bb867dd02b76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__p_mem.html#gae9503a4071a5bc311a41bb867dd02b76">MmInitPhysicalAllocator</a> (struct KernelEntryArgs *kernelArgs)</td></tr>
<tr class="memdesc:gae9503a4071a5bc311a41bb867dd02b76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize physical memory allocator.  <br /></td></tr>
<tr class="separator:gae9503a4071a5bc311a41bb867dd02b76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3abe6018fd9edb2597cc8c874dc0075f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__p_mem.html#ga3abe6018fd9edb2597cc8c874dc0075f">MmCheckIfPhysicalMemoryUsable</a> (uintptr_t address, uintptr_t size)</td></tr>
<tr class="memdesc:ga3abe6018fd9edb2597cc8c874dc0075f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if given physical memory region is usable at all.  <br /></td></tr>
<tr class="separator:ga3abe6018fd9edb2597cc8c874dc0075f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa68566b055973e2e2934168fe522d8e7" name="gaa68566b055973e2e2934168fe522d8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa68566b055973e2e2934168fe522d8e7">&#9670;&#160;</a></span>MmAllocateContiguousPhysicalMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT uintptr_t MmAllocateContiguousPhysicalMemory </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t *&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>align</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate contiguous physical memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Byte Count </td></tr>
    <tr><td class="paramname">*address</td><td>Allocated physical memory address </td></tr>
    <tr><td class="paramname">align</td><td>Requested alignment in bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes actually allocated. 0 when no contiguous block of size n was found. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is slow and should not be used when not needed. </dd></dl>

</div>
</div>
<a id="gaa5652a7ae272940055761950cd479153" name="gaa5652a7ae272940055761950cd479153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5652a7ae272940055761950cd479153">&#9670;&#160;</a></span>MmAllocatePhysicalMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t MmAllocatePhysicalMemory </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate ONE physical memory block (best fit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Byte count </td></tr>
    <tr><td class="paramname">*address</td><td>Allocated physical memory address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes actually allocated. 0 when memory is full. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This is a very low level utility and should not be used by anything but the memory allocator</dd></dl>
<p>This function allocates exactly ONE memory block. The number of requested bytes and actually allocated bytes differs when the biggest available block is too small. In such scenario that smaller block -is- allocated anyway and the higher-level function should look for next non-contiguous memory blocks to fulfill the request. This also happens when the requested size is bigger than the biggest block size, even if there are more contiguous block (there is just no higher order block). Of course when there is not a single lowest order block available nothing is allocated and 0 is returned. </p>

</div>
</div>
<a id="ga3abe6018fd9edb2597cc8c874dc0075f" name="ga3abe6018fd9edb2597cc8c874dc0075f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3abe6018fd9edb2597cc8c874dc0075f">&#9670;&#160;</a></span>MmCheckIfPhysicalMemoryUsable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MmCheckIfPhysicalMemoryUsable </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if given physical memory region is usable at all. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>Region start address </td></tr>
    <tr><td class="paramname">size</td><td>Region size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if usable, 0 if not </dd></dl>

</div>
</div>
<a id="ga7b35a215c11279c86f4fdd953f0677ef" name="ga7b35a215c11279c86f4fdd953f0677ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b35a215c11279c86f4fdd953f0677ef">&#9670;&#160;</a></span>MmFreePhysicalMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT void MmFreePhysicalMemory </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free physical memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>Starting address </td></tr>
    <tr><td class="paramname">n</td><td>Byte count. Freeing 0 bytes has no effect </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>It is a caller's responsibility to free non-contiguous memory fragment by fragment </dd></dl>

</div>
</div>
<a id="gae9503a4071a5bc311a41bb867dd02b76" name="gae9503a4071a5bc311a41bb867dd02b76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9503a4071a5bc311a41bb867dd02b76">&#9670;&#160;</a></span>MmInitPhysicalAllocator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MmInitPhysicalAllocator </td>
          <td>(</td>
          <td class="paramtype">struct KernelEntryArgs *&#160;</td>
          <td class="paramname"><em>kernelArgs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize physical memory allocator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*kernelArgs</td><td>Pointer to the arguments passed to kernel by bootloader </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This function should be called only once </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
